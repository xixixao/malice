BSOMetaParser=subclass(BSDentParser,{
"lineComment":function(){return this._applyWithArgs("fromTo",'# ','\n')},
"blockComment":function(){return this._applyWithArgs("fromTo",'#>','<#')},
"space":function(){return this._or((function(){return (function(){switch(this._apply('anything')){case " ":return " ";default: throw this.fail}}).call(this)}),(function(){return this._apply("spacedent")}),(function(){return this._apply("lineComment")}),(function(){return this._apply("blockComment")}))},
"blankLine":function(){return this._or((function(){return (function(){this._many((function(){return this._applyWithArgs("exactly"," ")}));return this._or((function(){return this._apply("lineComment")}),(function(){return (function(){this._apply("blockComment");this._many((function(){return this._applyWithArgs("exactly"," ")}));return this._applyWithArgs("exactly","\n")}).call(this)}))}).call(this)}),(function(){return BSDentParser._superApplyWithArgs(this,'blankLine')}))},
"nameFirst":function(){return this._or((function(){return (function(){switch(this._apply('anything')){case "_":return "_";case "$":return "$";default: throw this.fail}}).call(this)}),(function(){return this._apply("letter")}))},
"bareName":function(){return this._consumedBy((function(){return (function(){this._apply("nameFirst");return this._many((function(){return this._or((function(){return this._apply("nameFirst")}),(function(){return this._apply("digit")}))}))}).call(this)}))},
"name":function(){return (function(){this._apply("spaces");return this._apply("bareName")}).call(this)},
"hexValue":function(){var ch;return (function(){at=this._idxConsumedBy((function(){return ch=this._apply("anything")}));return '0123456709abcdef'.indexOf(ch.toLowerCase())}).call(this)},
"hexDigit":function(){var x,v;return (function(){at=this._idxConsumedBy((function(){return (function(){x=this._apply("char");v=this.hexValue(x);return this._pred(v >= 0)}).call(this)}));return v}).call(this)},
"escapedChar":function(){var s;return this._or((function(){return (function(){at=this._idxConsumedBy((function(){return s=this._consumedBy((function(){return (function(){this._applyWithArgs("exactly","\\");return this._or((function(){return (function(){switch(this._apply('anything')){case "u":return (function(){this._apply("hexDigit");this._apply("hexDigit");this._apply("hexDigit");return this._apply("hexDigit")}).call(this);case "x":return (function(){this._apply("hexDigit");return this._apply("hexDigit")}).call(this);default: throw this.fail}}).call(this)}),(function(){return this._apply("char")}))}).call(this)}))}));return unescape(s)}).call(this)}),(function(){return this._apply("char")}))},
"charSequence":function(){var xs;return (function(){at=this._idxConsumedBy((function(){return (function(){this._applyWithArgs("exactly","\"");xs=this._many((function(){return (function(){this._not((function(){return this._applyWithArgs("exactly","\"")}));return this._apply("escapedChar")}).call(this)}));return this._applyWithArgs("exactly","\"")}).call(this)}));return (function(){
  var string;
  string = programString(xs.join(''));
  this.usedTokens.add(string);
  return ['App', 'token', string];
}).call(this)}).call(this)},
"string":function(){var xs;return (function(){at=this._idxConsumedBy((function(){return (function(){this._applyWithArgs("exactly","\'");xs=this._many((function(){return (function(){this._not((function(){return this._applyWithArgs("exactly","\'")}));return this._apply("escapedChar")}).call(this)}));return this._applyWithArgs("exactly","\'")}).call(this)}));return ['App', 'exactly', programString(xs.join(''))]}).call(this)},
"number":function(){var n;return (function(){at=this._idxConsumedBy((function(){return n=this._consumedBy((function(){return (function(){this._opt((function(){return this._applyWithArgs("exactly","-")}));return this._many1((function(){return this._apply("digit")}))}).call(this)}))}));return ['App', 'exactly', n]}).call(this)},
"keyword":function(){var xs;return (function(){xs=this._apply("anything");at=this._idxConsumedBy((function(){return (function(){this._applyWithArgs("token",xs);return this._not((function(){return this._apply("letterOrDigit")}))}).call(this)}));return xs}).call(this)},
"args":function(){var xs;return this._or((function(){return (function(){at=this._idxConsumedBy((function(){return (function(){this._applyWithArgs("exactly","(");xs=this._applyWithArgs("listOf",'hostExpr',',');return this._applyWithArgs("token",")")}).call(this)}));return xs}).call(this)}),(function(){return (function(){at=this._idxConsumedBy((function(){return this._apply("empty")}));return []}).call(this)}))},
"application":function(){var rule,as,grm;return this._or((function(){return (function(){at=this._idxConsumedBy((function(){return (function(){this._applyWithArgs("token","^");rule=this._apply("name");return as=this._apply("args")}).call(this)}));return ['App', "super", "'" + rule + "'"].concat(as)}).call(this)}),(function(){return (function(){at=this._idxConsumedBy((function(){return (function(){grm=this._apply("name");this._applyWithArgs("token",".");rule=this._apply("name");return as=this._apply("args")}).call(this)}));return ['App', "foreign", grm, "'" + rule + "'"].concat(as)}).call(this)}),(function(){return (function(){at=this._idxConsumedBy((function(){return (function(){rule=this._apply("name");return as=this._apply("args")}).call(this)}));return ['App', rule].concat(as)}).call(this)}))},
"hostExpr":function(){return this._applyWithArgs("foreign",BSSemActionParser,'simpleExp',this.locals.values())},
"closedHostExpr":function(){return this._applyWithArgs("foreign",BSSemActionParser,'delimSemAction',this.locals.values())},
"openHostExpr":function(){var p;return (function(){p=this._apply("anything");return this._applyWithArgs("foreign",BSSemActionParser,'semAction',p,this.locals.values())}).call(this)},
"semAction":function(){var x;return (function(){at=this._idxConsumedBy((function(){return x=this._apply("closedHostExpr")}));return ['Act', x]}).call(this)},
"arrSemAction":function(){var p,x;return (function(){at=this._idxConsumedBy((function(){return (function(){this._applyWithArgs("token","->");p=this._apply("linePos");return x=this._applyWithArgs("openHostExpr",p)}).call(this)}));return ['Act', x]}).call(this)},
"semPred":function(){var x;return this._or((function(){return (function(){at=this._idxConsumedBy((function(){return (function(){this._applyWithArgs("token","&");return x=this._apply("closedHostExpr")}).call(this)}));return ['Pred', x]}).call(this)}),(function(){return (function(){at=this._idxConsumedBy((function(){return (function(){this._applyWithArgs("token","!");return x=this._apply("closedHostExpr")}).call(this)}));return ['Not', ['Pred', x]]}).call(this)}))},
"expr":function(){var p,x;return (function(){p=this._apply("anything");at=this._idxConsumedBy((function(){return (function(){this._applyWithArgs("setdent",p);x=this._apply("expr5");return this.redent()}).call(this)}));return x}).call(this)},
"expr5":function(){var x,xs;return this._or((function(){return (function(){at=this._idxConsumedBy((function(){return (function(){x=this._applyWithArgs("expr4",true);return xs=this._many1((function(){return (function(){this._applyWithArgs("token","|");return this._applyWithArgs("expr4",true)}).call(this)}))}).call(this)}));return ['Or', x].concat(xs)}).call(this)}),(function(){return (function(){at=this._idxConsumedBy((function(){return (function(){x=this._applyWithArgs("expr4",true);return xs=this._many1((function(){return (function(){this._applyWithArgs("token","||");return this._applyWithArgs("expr4",true)}).call(this)}))}).call(this)}));return ['XOr', x].concat(xs)}).call(this)}),(function(){return this._applyWithArgs("expr4",false)}))},
"expr4":function(){var ne,xs,act;return (function(){ne=this._apply("anything");return this._or((function(){return (function(){at=this._idxConsumedBy((function(){return (function(){xs=this._many((function(){return this._apply("expr3")}));return act=this._apply("arrSemAction")}).call(this)}));return ['And', ['Set', 'at', ['IdxConsBy', ['And'].concat(xs)]], act]}).call(this)}),(function(){return (function(){at=this._idxConsumedBy((function(){return (function(){this._pred(ne);return xs=this._many1((function(){return this._apply("expr3")}))}).call(this)}));return ['And'].concat(xs)}).call(this)}),(function(){return (function(){at=this._idxConsumedBy((function(){return (function(){this._not((function(){return this._pred(ne)}));return xs=this._many((function(){return this._apply("expr3")}))}).call(this)}));return ['And'].concat(xs)}).call(this)}))}).call(this)},
"optIter":function(){var x;return (function(){x=this._apply("anything");return this._or((function(){return (function(){at=this._idxConsumedBy((function(){return this._applyWithArgs("exactly","*")}));return ['Many', x]}).call(this)}),(function(){return (function(){at=this._idxConsumedBy((function(){return this._applyWithArgs("exactly","+")}));return ['Many1', x]}).call(this)}),(function(){return (function(){at=this._idxConsumedBy((function(){return this._applyWithArgs("exactly","?")}));return ['Opt', x]}).call(this)}),(function(){return (function(){at=this._idxConsumedBy((function(){return this._apply("empty")}));return x}).call(this)}))}).call(this)},
"optBind":function(){var x,n;return (function(){x=this._apply("anything");return this._or((function(){return (function(){at=this._idxConsumedBy((function(){return (function(){this._applyWithArgs("exactly",":");return n=this._apply("name")}).call(this)}));return (function(){
  this.locals.add(n);
  return ['Set', n, x];
}).call(this)}).call(this)}),(function(){return (function(){at=this._idxConsumedBy((function(){return this._apply("empty")}));return x}).call(this)}))}).call(this)},
"expr3":function(){var n,x,e;return this._or((function(){return (function(){at=this._idxConsumedBy((function(){return (function(){this._applyWithArgs("token",":");return n=this._apply("name")}).call(this)}));return (function(){
  this.locals.add(n);
  return ['Set', n, ['App', 'anything']];
}).call(this)}).call(this)}),(function(){return (function(){e=this._or((function(){return (function(){x=this._apply("expr2");return this._applyWithArgs("optIter",x)}).call(this)}),(function(){return this._apply("semAction")}));return this._applyWithArgs("optBind",e)}).call(this)}),(function(){return this._apply("semPred")}))},
"expr2":function(){var x;return this._or((function(){return (function(){at=this._idxConsumedBy((function(){return (function(){this._applyWithArgs("token","!");return x=this._apply("expr2")}).call(this)}));return ['Not', x]}).call(this)}),(function(){return (function(){at=this._idxConsumedBy((function(){return (function(){this._applyWithArgs("token","&");return x=this._apply("expr1")}).call(this)}));return ['Lookahead', x]}).call(this)}),(function(){return this._apply("expr1")}))},
"expr1":function(){var x;return this._or((function(){return this._apply("application")}),(function(){return (function(){at=this._idxConsumedBy((function(){return x=this._or((function(){return this._applyWithArgs("keyword",'undefined')}),(function(){return this._applyWithArgs("keyword",'nil')}),(function(){return this._applyWithArgs("keyword",'true')}),(function(){return this._applyWithArgs("keyword",'false')}))}));return ['App', 'exactly', x]}).call(this)}),(function(){return (function(){this._apply("spaces");return this._or((function(){return this._apply("charSequence")}),(function(){return this._apply("string")}),(function(){return this._apply("number")}))}).call(this)}),(function(){return (function(){at=this._idxConsumedBy((function(){return (function(){this._applyWithArgs("token","[");x=this._applyWithArgs("expr",0);return this._applyWithArgs("token","]")}).call(this)}));return ['Form', x]}).call(this)}),(function(){return (function(){at=this._idxConsumedBy((function(){return (function(){this._applyWithArgs("token","<");x=this._applyWithArgs("expr",0);return this._applyWithArgs("token",">")}).call(this)}));return ['ConsBy', x]}).call(this)}),(function(){return (function(){at=this._idxConsumedBy((function(){return (function(){this._applyWithArgs("token","@<");x=this._applyWithArgs("expr",0);return this._applyWithArgs("token",">")}).call(this)}));return ['IdxConsBy', x]}).call(this)}),(function(){return (function(){at=this._idxConsumedBy((function(){return (function(){this._applyWithArgs("token","(");x=this._applyWithArgs("expr",0);return this._applyWithArgs("token",")")}).call(this)}));return x}).call(this)}))},
"ruleName":function(){return this._apply("bareName")},
"rule":function(){var n,p,x,xs;return (function(){at=this._idxConsumedBy((function(){return (function(){this._lookahead((function(){return n=this._apply("ruleName")}));this.locals = new Set;p=this._apply("linePos");this._applyWithArgs("setdent",p + 1);x=this._applyWithArgs("rulePart",n);xs=this._many((function(){return (function(){this._applyWithArgs("nodent",p);return this._applyWithArgs("rulePart",n)}).call(this)}));return this.redent()}).call(this)}));return ['Rule', n, this.locals.values(), ['Or', x].concat(xs)]}).call(this)},
"rulePart":function(){var rn,n,b1,p,b2;return (function(){rn=this._apply("anything");n=this._apply("ruleName");this._pred(n === rn);return this._or((function(){return (function(){b1=this._applyWithArgs("expr4",false);return this._or((function(){return (function(){at=this._idxConsumedBy((function(){return (function(){this._apply("spaces");p=this._apply("linePos");this._applyWithArgs("exactly","=");return b2=this._applyWithArgs("expr",p)}).call(this)}));return ['And', b1, b2]}).call(this)}),(function(){return (function(){at=this._idxConsumedBy((function(){return this._apply("empty")}));return b1}).call(this)}))}).call(this)}),(function(){return this._applyWithArgs("error","Error in syntax of rule " + n)}))}).call(this)},
"grammar":function(){var ss,ip,n,sn,p,r,rs;return (function(){ip=(function(){at=this._idxConsumedBy((function(){return ss=this._many((function(){return this._apply("inspace")}))}));return 1 + ss.length}).call(this);this.usedTokens = new Set;this._applyWithArgs("keyword",'ometa');n=this._apply("name");sn=this._or((function(){return (function(){this._applyWithArgs("keyword",'extends');return this._apply("name")}).call(this)}),(function(){return (function(){at=this._idxConsumedBy((function(){return this._apply("empty")}));return 'OMeta'}).call(this)}));this._applyWithArgs("moredent",ip);p=this._apply("linePos");r=this._apply("rule");rs=this._many((function(){return (function(){this._applyWithArgs("nodent",p);return this._apply("rule")}).call(this)}));return this._applyWithArgs("foreign",BSOMetaOptimizer,'optimizeGrammar',['Grammar', n, sn, this.usedTokens.values(), r].concat(rs))}).call(this)}, usedTokens: [")","^",".","->","&","!","|","||",":","[","]","<",">","@<","("]});;


